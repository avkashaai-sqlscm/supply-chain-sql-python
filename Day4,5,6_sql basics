SELECT PRODUCTLINE, SUM(SALES) AS total_sales
FROM sales_data_sample
GROUP BY PRODUCTLINE;
--
SELECT PRODUCTLINE, SUM(SALES) AS total_sales
FROM sales_data_sample
GROUP BY PRODUCTLINE
HAVING SUM(SALES) > 10000
ORDER BY total_sales DESC;
\\
SELECT PRODUCTLINE, AVG(PRICEEACH) AS avg_price
FROM sales_data_sample
GROUP BY PRODUCTLINE
HAVING AVG(PRICEEACH) > 50;
--
CREATE TABLE IF NOT EXISTS products AS
SELECT DISTINCT PRODUCTCODE, PRODUCTLINE, MSRP
FROM sales_data_sample;
--
SELECT s.PRODUCTCODE, p.PRODUCTLINE, SUM(s.SALES) AS total_sales
FROM sales_data_sample s
JOIN products p ON s.PRODUCTCODE = p.PRODUCTCODE
GROUP BY s.PRODUCTCODE, p.PRODUCTLINE
ORDER BY total_sales DESC
LIMIT 20;
---
SELECT s.PRODUCTCODE, p.PRODUCTLINE, SUM(s.SALES) AS total_sales
FROM sales_data_sample s
LEFT JOIN products p ON s.PRODUCTCODE = p.PRODUCTCODE
GROUP BY s.PRODUCTCODE, p.PRODUCTLINE;
---
SELECT PRODUCTLINE, PRODUCTCODE,
       ROW_NUMBER() OVER (PARTITION BY PRODUCTLINE ORDER BY SALES DESC) AS rn
FROM sales_data_sample;
====
SELECT PRODUCTCODE, SALES,
       RANK() OVER (ORDER BY SALES DESC) AS rnk
FROM sales_data_sample;
-----
SELECT ORDERDATE, SALES,
       SUM(SALES) OVER (ORDER BY ORDERDATE) AS running_total
FROM sales_data_sample;
-----
SELECT PRODUCTCODE, ORDERDATE, SALES,
       AVG(SALES) OVER (ORDER BY ORDERDATE ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mov_avg_3
FROM sales_data_sample;
----
SELECT PRODUCTCODE, ORDERDATE, SALES,
       LAG(SALES) OVER (ORDER BY ORDERDATE) AS prev_week_sales,
       LEAD(SALES) OVER (ORDER BY ORDERDATE) AS next_week_sales
FROM sales_data_sample;
----
SELECT PRODUCTCODE, ORDERDATE, SALES,
       SALES - LAG(SALES) OVER (ORDER BY ORDERDATE) AS diff_vs_prev
FROM sales_data_sample;
-------
